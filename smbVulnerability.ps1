# Define secure TLS 1.2 ciphers
$secureCiphers = @(
    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
)
# Disable insecure ciphers
$insecureCiphers = @(
    "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
    "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA"
)
# Update registry settings
foreach ($cipher in $insecureCiphers) {
    Write-Host "Disabling insecure cipher: $cipher"
    Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\$cipher" -Name "Enabled" -Value 0 -Type DWord
}
foreach ($cipher in $secureCiphers) {
    Write-Host "Enabling secure cipher: $cipher"
    Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\$cipher" -Name "Enabled" -Value 1 -Type DWord
}
Write-Host "Cipher suite remediation complete. Restart the system for changes to take effect."
 
 
# Set SMBv2 signing to "not required"
 
Write-Host "Disabling required SMBv2 signing..."
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" -Name "RequireSecuritySignature" -Value 0 -Type DWord
 
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters" -Name "EnableSecuritySignature" -Value 0 -Type DWord
Write-Host "SMBv2 signing requirement disabled. Restart the system for changes to take effect."